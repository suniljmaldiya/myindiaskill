<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exam Controller - Green Valley High School</title>

<style>
/* -------- GLOBAL STYLE -------- */
body {
  font-family: "Poppins", sans-serif;
  background: linear-gradient(135deg, #c8f7c5, #a5e6f0);
  margin: 0;
  padding: 0;
  min-height: 100vh;
}

/* -------- HEADER -------- */
header {
  background: linear-gradient(90deg, #4CAF50, #2E7D32);
  color: white;
  text-align: center;
  padding: 20px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}

header h1 {
  margin: 0;
  font-size: 28px;
  letter-spacing: 1px;
}
header h2 {
  margin-top: 5px;
  font-weight: 400;
  font-size: 18px;
}

/* -------- CONTAINER -------- */
.container {
  max-width: 850px;
  margin: 40px auto;
  background: white;
  padding: 30px;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}

/* -------- FORM ELEMENTS -------- */
label {
  display: block;
  margin-top: 12px;
  font-weight: 600;
  color: #333;
}

select, input[type="number"], input[type="text"], input[type="password"] {
  width: 100%;
  padding: 10px 14px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-top: 6px;
  transition: 0.2s;
}

select:focus, input:focus {
  border-color: #4CAF50;
  outline: none;
  box-shadow: 0 0 6px rgba(76,175,80,0.3);
}

button {
  background: linear-gradient(90deg, #2196F3, #0b7dda);
  color: white;
  border: none;
  padding: 12px 20px;
  border-radius: 8px;
  font-size: 16px;
  cursor: pointer;
  margin-top: 18px;
  width: 100%;
  transition: 0.3s;
}

button:hover {
  background: linear-gradient(90deg, #1976D2, #0a5cb5);
}

/* -------- SUBJECT ROWS -------- */
.subject-inputs {
  margin-top: 25px;
}

.subject-inputs h3 {
  margin-bottom: 15px;
  color: #2E7D32;
  font-size: 20px;
  text-align: center;
}

.subject-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 10px;
}

.subject-row label {
  flex: 1;
  font-weight: 500;
}

.subject-row input {
  flex: 1;
}

/* -------- MESSAGE BOXES -------- */
.success {
  background: #d4edda;
  color: #155724;
  padding: 12px;
  border-radius: 8px;
  text-align: center;
  margin-top: 15px;
  font-weight: 600;
}

.error {
  background: #f8d7da;
  color: #721c24;
  padding: 12px;
  border-radius: 8px;
  text-align: center;
  margin-top: 15px;
  font-weight: 600;
}

/* -------- LOGIN BOX -------- */
#loginDiv {
  text-align: center;
}

#loginDiv h2 {
  color: #333;
  margin-bottom: 10px;
}

/* -------- LOGOUT BUTTON -------- */
.logout-btn {
  background: #f44336;
  margin-top: 30px;
}

.logout-btn:hover {
  background: #d32f2f;
}

/* -------- RESPONSIVE -------- */
@media (max-width: 600px) {
  .subject-row {
    flex-direction: column;
    align-items: flex-start;
  }
}
</style>
</head>

<body>

<header>
  <h1>Green Valley High School</h1>
  <h2>Exam Controller Panel</h2>
</header>

<div class="container">

  <!-- LOGIN SECTION -->
  <div id="loginDiv">
    <h2>Login to Access</h2>
    <label>Username:</label>
    <input type="text" id="username" placeholder="Enter username">
    <label>Password:</label>
    <input type="password" id="password" placeholder="Enter password">
    <button onclick="login()">Login</button>
    <p id="loginMsg"></p>
  </div>

  <!-- CONTROLLER SECTION -->
  <div id="controllerDiv" style="display:none;">
    <h2 style="text-align:center;">Input / Update Student Result</h2>

    <label for="yearSelect">Select Year:</label>
    <select id="yearSelect"></select>

    <label for="semesterSelect">Select Semester:</label>
    <select id="semesterSelect">
      <option value="1">1st Semester</option>
      <option value="2">2nd Semester</option>
    </select>

    <label for="classSelect">Class:</label>
    <select id="classSelect">
      <option value="1">Class 1</option>
      <option value="2">Class 2</option>
      <option value="3">Class 3</option>
      <option value="4">Class 4</option>
      <option value="5">Class 5</option>
      <option value="6">Class 6</option>
      <option value="7">Class 7</option>
      <option value="8">Class 8</option>
      <option value="9">Class 9</option>
      <option value="10">Class 10</option>
    </select>

    <label for="sectionSelect">Section:</label>
    <select id="sectionSelect">
      <option value="A">A</option>
      <option value="B">B</option>
      <option value="C">C</option>
    </select>

    <label for="rollInput">Roll:</label>
    <input type="number" id="rollInput" min="1" placeholder="Enter Roll Number">

    <div class="subject-inputs" id="subjectInputs"></div>

    <button onclick="saveResult()">üíæ Save Result</button>
    <div id="message"></div>
    <button class="logout-btn" onclick="logout()">üö™ Logout</button>
  </div>

</div>

<script>
/* ---------------- AUTH SYSTEM ---------------- */
const USER = "admin";
const PASS = "1234";

function login(){
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  if(u===USER && p===PASS){
    sessionStorage.setItem("loggedIn", "true");
    document.getElementById("loginDiv").style.display="none";
    document.getElementById("controllerDiv").style.display="block";
  } else {
    document.getElementById("loginMsg").textContent = "‚ùå Invalid username or password!";
    document.getElementById("loginMsg").style.color = "red";
  }
}

function checkLogin(){
  if(sessionStorage.getItem("loggedIn")==="true"){
    document.getElementById("loginDiv").style.display="none";
    document.getElementById("controllerDiv").style.display="block";
  }
}
function logout(){
  sessionStorage.removeItem("loggedIn");
  location.reload();
}
checkLogin();

/* ---------------- YEAR DROPDOWN ---------------- */
const yearSelect=document.getElementById("yearSelect");
for(let y=2022;y<=2025;y++){
  const opt=document.createElement("option");
  opt.value=y; opt.textContent=y;
  yearSelect.appendChild(opt);
}

/* Disable 2nd semester if year = 2025 */
yearSelect.addEventListener("change", function(){
  const semSel=document.getElementById("semesterSelect");
  if(this.value=="2025"){
    semSel.innerHTML='<option value="1">1st Semester</option>';
  }else{
    semSel.innerHTML='<option value="1">1st Semester</option><option value="2">2nd Semester</option>';
  }
});

/* ---------------- SUBJECT LOGIC ---------------- */
function getSubjects(cls){
  if(cls<=5){
    return ["Math","English","Bangla","Science","ICT"];
  }else{
    return ["Math","English","Bangla","Physics","Chemistry","Biology","ICT","History","Geography","Economics"];
  }
}

/* ---------------- INITIALIZE STUDENTS ---------------- */
if(!localStorage.getItem("studentsData")){
  const sections=['A','B','C'];
  const students=[];
  for(let cls=1;cls<=10;cls++){
    sections.forEach(sec=>{
      for(let roll=1;roll<=50;roll++){
        const subs=getSubjects(cls);
        const marksObj={};
        subs.forEach(sub=>marksObj[sub]=Math.floor(Math.random()*41)+60);
        students.push({
          name:`Student_${cls}${sec}${roll}`,
          class:cls,
          section:sec,
          roll:roll,
          id:`C${cls}${sec}${roll.toString().padStart(2,'0')}`,
          marks:{ "2025":{ "1": marksObj } },
          presentDays:Math.floor(Math.random()*11)+110
        });
      }
    });
  }
  localStorage.setItem("studentsData", JSON.stringify(students));
}
let students=JSON.parse(localStorage.getItem("studentsData"));

/* ---------------- SUBJECT INPUT GENERATION ---------------- */
function generateSubjects(){
  const cls=parseInt(document.getElementById("classSelect").value);
  const year=parseInt(document.getElementById("yearSelect").value);
  let classAtYear=cls-(2025-year);
  if(classAtYear<1) classAtYear=1;

  const subs=getSubjects(classAtYear);
  const div=document.getElementById("subjectInputs");
  div.innerHTML="<h3>Enter Marks (0 - 100)</h3>";
  subs.forEach(sub=>{
    div.innerHTML += `
      <div class="subject-row">
        <label>${sub}</label>
        <input type="number" id="sub_${sub}" min="0" max="100" value="0">
      </div>`;
  });
}

document.getElementById("classSelect").addEventListener("change",generateSubjects);
document.getElementById("yearSelect").addEventListener("change",generateSubjects);
generateSubjects();

/* ---------------- SAVE RESULT FUNCTION ---------------- */
function saveResult(){
  const cls=parseInt(document.getElementById("classSelect").value);
  const sec=document.getElementById("sectionSelect").value;
  const roll=parseInt(document.getElementById("rollInput").value);
  const year=parseInt(document.getElementById("yearSelect").value);
  const sem=parseInt(document.getElementById("semesterSelect").value);
  const msg=document.getElementById("message");

  if(!roll){ msg.innerHTML='<div class="error">Please enter roll number!</div>'; return; }
  if(year==2025 && sem==2){
    msg.innerHTML='<div class="error">‚ö†Ô∏è Future semester (2025 2nd) cannot be saved!</div>';
    return;
  }

  const student=students.find(s=>s.class==cls && s.section==sec && s.roll==roll);
  if(!student){ msg.innerHTML='<div class="error">Student not found!</div>'; return; }

  let classAtYear=cls-(2025-year);
  if(classAtYear<1) classAtYear=1;
  const subs=getSubjects(classAtYear);
  const marksObj={};
  let valid=true;
  subs.forEach(sub=>{
    const mark=parseInt(document.getElementById(`sub_${sub}`).value);
    if(isNaN(mark)||mark<0||mark>100) valid=false;
    marksObj[sub]=mark;
  });
  if(!valid){ msg.innerHTML='<div class="error">‚ùå Invalid marks entered!</div>'; return; }

  if(!student.marks[year]) student.marks[year]={};
  student.marks[year][sem]=marksObj;
  localStorage.setItem("studentsData", JSON.stringify(students));

  msg.innerHTML=`<div class="success">‚úÖ Result updated for ${student.name} (Roll ${student.roll}) ‚Äî Year ${year} Semester ${sem}</div>`;
}
</script>
</body>
</html>
